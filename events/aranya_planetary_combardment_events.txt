
#########################################
#
# Planetary bombardnemt event
#
#########################################

namespace = aranya_bombardment_event

# 100X Turning the world into the hellish world when bombarded with HELLRAISER stance
planet_event = {
	id = aranya_bombardment_event.1001
	is_triggered_only = yes
	hide_window = yes

	#Hellraise this planet if...
	trigger = {
		planet_devastation >= 100
		has_orbital_bombardment_stance = aranya_bombardment_hellraising
		OR = {
			habitable_planet = yes
			is_planet_class = pc_ringworld_habitable
			is_planet_class = pc_habitat
		}
		NOT = {
			has_planet_flag = bombardment_cooldown
		}
	}

	#What happends after the devastation reached 100%
	immediate = {
		add_threat = { who = from.owner amount = 20 }
		destroy_colony = yes
		every_owned_pop = {
			kill_pop = yes
		}

		#Destroy every pieces of shit on the planet
		remove_all_buildings = yes
		reroll_deposits = yes
		clear_planet_modifiers = yes

		add_opinion_modifier = {
			modifier = opinion_aranya_hellraising_our_planet
		}

		#Imform the destruction of the planet to all country.
		every_country = {
			limit = {
				NOR = {
					is_same_value = from.owner
					is_same_value = root.owner
				}
				OR = {
					has_communications = from.owner
					has_communications = root.owner
				}
				OR = {
					AND = {
						has_federation = yes
						is_in_federation_with = root.owner
					}
					AND = {
						is_country_type = default
						OR = {
							is_egalitarian = yes
							is_xenophile = yes
							is_pacifist = yes
						}
					}
				}
			}
			add_opinion_modifier = {
				modifier = opinion_aranya_hellraising_planet
			}
			country_event = { id = aranya_bombardment_event.99001 }
		}
		if = {
			limit = {
				NOR = {
					is_planet_class = pc_ringworld_habitable
					is_planet_class = pc_habitat
				}
			}
			change_pc = pc_aranya_hellish_world	
			reset_planet = yes
		}
		else_if = {
			limit = {
				is_ringworld = yes 
			}
			change_pc = pc_ringworld_habitable_damaged
			reset_planet = yes
		}
		else_if = {
			limit = {
				is_planet_class = pc_habitat
			}
			reset_planet = yes
		}
	}
}



